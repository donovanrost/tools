---

- name: Check if XCode Command Line Tools are installed
  shell: xcode-select -p
  register: xcode_check_result

- name: Install XCode Command Line Tools
  shell: xcode-select --install
  when: xcode_check_result.rc == 1

- name: Install Python Build Environment Tools
  community.general.homebrew:
    update_homebrew: yes
    name:
      - openssl
      - readline
      - sqlite3
      - xz
      - zlib

- name: Check if asdf plugin list has python
  shell: asdf plugin list | grep python
  register: has_python_plugin
  failed_when: has_python_plugin.rc > 1

- name: Install python asdf plugin
  shell: asdf plugin add python
  when: has_python_plugin.rc == 1

- name: Install modern python version
  shell: asdf install python 3.11.0

- name: Set Global version of python
  shell: asdf global python 3.11.0

